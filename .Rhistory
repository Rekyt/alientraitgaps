?usethis::use_data
# Load TRY data ----------------------------------------------------------------
try_df = disk.frame::disk.frame(
here::here("inst", "exdata", "16037.df")
)
head(try_df)
# Load TRY data ----------------------------------------------------------------
try_df = disk.frame::disk.frame(
here::here("inst", "exdata", "try", "16037.df")
)
head(try_df)
# Packages ---------------------------------------------------------------------
library("dplyr")
try_df %>%
distinct(TraitID, TraitName)
try_df %>%
disk.frame::chunk_distinct(TraitID, TraitName) %>%
collect() %>%
distinct(TraitID, TraitName)
try_species = read.csv(
here::here("inst", "exdata", "try", "TryAccSpecies.txt")
)
try_species = readr::read_table(
here::here("inst", "exdata", "try", "TryAccSpecies.txt")
)
head(try_species)
# Load TRY data ----------------------------------------------------------------
try_df = disk.frame::disk.frame(
here::here("inst", "exdata", "try", "12477.df")
)
try_df %>%
disk.frame::chunk_distinct(TraitID, TraitName) %>%
collect() %>%
distinct(TraitID, TraitName)
# Preliminary script to make figures for GloNAF talk
# Packages ---------------------------------------------------------------------
library("dplyr")
library("ggplot2")
# Functions --------------------------------------------------------------------
# Load TRY data ----------------------------------------------------------------
try_df = disk.frame::disk.frame(
here::here("inst", "exdata", "try", "12477.df")
)
try_species = readr::read_table(
here::here("inst", "exdata", "try", "TryAccSpecies.txt")
)
# Load GloNAF data -------------------------------------------------------------
glonaf_db_con = DBI::dbConnect(
RMariaDB::MariaDB(),
dbname = "glonafdb",
username = Sys.getenv("GLONAF_USER"),
password = Sys.getenv("GLONAF_PASSWORD"),
host = "134.34.205.46",
port = 6609
)
glonaf_species = DBI::dbGetQuery(
glonaf_con,
paste0(
"SELECT DISTINCT taxon_orig.id AS taxon_orig_id, taxon_orig.taxon_orig, ",
"family_tpl.name AS family, taxon_orig.species_id, genus.name AS genus, ",
"species.hybrid, species.epithet, infra_rank.name AS infra_rank, ",
"species.epithet_infra, author.name AS author, ",
"name_status.name AS TPL_name_status_standardized, species.tpl_id, ",
"species.species_alt_id, taxon_orig.taxon_corrected, ",
"taxon_orig.gen_hybrid AS taxon_orig_genus_hybrid, ",
"taxon_orig.hybrid AS taxon_orig_hybrid, taxon_orig.abbrev, ",
"taxon_orig.cultivar, taxon_orig.cult_name, ",
"taxon_orig.TPL_Taxonomic_status AS TPL_name_status_orig FROM flora_orig",
"\nLEFT JOIN list ON flora_orig.list_id = list.id\n",
"LEFT JOIN taxon_orig ON flora_orig.taxon_orig_id = taxon_orig.id\n",
"LEFT JOIN species ON taxon_orig.species_id = species.id\n",
"LEFT JOIN genus ON species.genus_id = genus.id\n",
"LEFT JOIN family_tpl ON genus.family_tpl_id = family_tpl.id\n",
"LEFT JOIN infra_rank ON species.infra_rank_id = infra_rank.id\n",
"LEFT JOIN author ON species.author_id = author.id\n",
"LEFT JOIN name_status ON species.name_status_id = name_status.id\n",
"WHERE list.outdated = 0"
)
)
# Load GloNAF data -------------------------------------------------------------
glonaf_con = DBI::dbConnect(
RMariaDB::MariaDB(),
dbname = "glonafdb",
username = Sys.getenv("GLONAF_USER"),
password = Sys.getenv("GLONAF_PASSWORD"),
host = "134.34.205.46",
port = 6609
)
glonaf_species = DBI::dbGetQuery(
glonaf_con,
paste0(
"SELECT DISTINCT taxon_orig.id AS taxon_orig_id, taxon_orig.taxon_orig, ",
"family_tpl.name AS family, taxon_orig.species_id, genus.name AS genus, ",
"species.hybrid, species.epithet, infra_rank.name AS infra_rank, ",
"species.epithet_infra, author.name AS author, ",
"name_status.name AS TPL_name_status_standardized, species.tpl_id, ",
"species.species_alt_id, taxon_orig.taxon_corrected, ",
"taxon_orig.gen_hybrid AS taxon_orig_genus_hybrid, ",
"taxon_orig.hybrid AS taxon_orig_hybrid, taxon_orig.abbrev, ",
"taxon_orig.cultivar, taxon_orig.cult_name, ",
"taxon_orig.TPL_Taxonomic_status AS TPL_name_status_orig FROM flora_orig",
"\nLEFT JOIN list ON flora_orig.list_id = list.id\n",
"LEFT JOIN taxon_orig ON flora_orig.taxon_orig_id = taxon_orig.id\n",
"LEFT JOIN species ON taxon_orig.species_id = species.id\n",
"LEFT JOIN genus ON species.genus_id = genus.id\n",
"LEFT JOIN family_tpl ON genus.family_tpl_id = family_tpl.id\n",
"LEFT JOIN infra_rank ON species.infra_rank_id = infra_rank.id\n",
"LEFT JOIN author ON species.author_id = author.id\n",
"LEFT JOIN name_status ON species.name_status_id = name_status.id\n",
"WHERE list.outdated = 0"
)
)
head(glonaf_species)
glonaf_species %>%
distinct(taxon_corrected) %>%
nrow()
remotes::install_github("idiv-biodiversity/lcvplants")
